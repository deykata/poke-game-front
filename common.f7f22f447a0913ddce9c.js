(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"1G5W":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("zx2A");function i(e){return t=>t.lift(new s(e))}class s{constructor(e){this.notifier=e}call(e,t){const n=new o(e),i=Object(r.c)(this.notifier,new r.a(n));return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n}}class o extends r.b{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}},"7drl":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("8Y7J"),i=n("SVse");const s=function(e){return{full:e}};let o=(()=>{class e{constructor(){this.emitter=new r.EventEmitter}ngOnInit(){}emitEvent(){this.emitter.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["app-ui-button"]],inputs:{text:"text",full:"full",disabled:"disabled"},outputs:{emitter:"emitter"},decls:2,vars:5,consts:[[1,"btn",3,"ngClass","disabled","click"],[3,"innerHtml"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"button",0),r["\u0275\u0275listener"]("click",function(){return t.emitEvent()}),r["\u0275\u0275element"](1,"span",1),r["\u0275\u0275elementEnd"]()),2&e&&(r["\u0275\u0275property"]("ngClass",r["\u0275\u0275pureFunction1"](3,s,t.full))("disabled",t.disabled),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("innerHtml",t.text,r["\u0275\u0275sanitizeHtml"]))},directives:[i.i],styles:[".full[_ngcontent-%COMP%]{width:100%}"]}),e})()},mrSG:function(e,t,n){"use strict";function r(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})}n.d(t,"a",function(){return r})},tsYp:function(e,t,n){"use strict";n.d(t,"a",function(){return x});var r=n("mrSG"),i=n("8Y7J"),s=n("XNiG"),o=n("1G5W"),a=n("IzEk"),l=n("0np6"),c=n("iInd"),p=n("fbMX"),d=n("TSSN"),m=n("ETNk"),u=n("IheW");let h=(()=>{class e{constructor(e){this.http=e}buildUrl(e){return l.a.API_URL_WRAPPER+l.a.W_USERS_BASE+e}doCheckUser(e){return this.http.post(this.buildUrl(l.a.W_USERS_CHECK),e)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](u.a))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=n("s7LF"),g=n("SVse"),v=n("7drl");const y=["settingsForm"],b=function(e){return{invalid:e}};function S(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",14,15),i["\u0275\u0275listener"]("ngModelChange",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().form.player=t}),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275reference"](1),t=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("ngModel",t.form.player)("ngClass",i["\u0275\u0275pureFunction1"](2,b,e.invalid&&(e.dirty||e.touched)))}}function E(e,t){if(1&e&&i["\u0275\u0275element"](0,"span",16),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("innerHtml",e.form.player,i["\u0275\u0275sanitizeHtml"])}}function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",17),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"translate"),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.key),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",i["\u0275\u0275pipeBind1"](2,2,""+e.value)," ")}}function C(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"option",17),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"translate"),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;i["\u0275\u0275property"]("value",e.key),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",i["\u0275\u0275pipeBind1"](2,2,""+e.value)," ")}}let x=(()=>{class e{constructor(e,t,n,r,o){this.route=e,this.storage=t,this.translate=n,this.themeService=r,this.userService=o,this.saved=new i.EventEmitter,this.storageKey=l.b.DB_SETTINGS,this.form={},this.options={},this.ngUnsubscribe=new s.a}ngOnInit(){this.prepForm(),this.autofillForm()}prepForm(){this.getTranslations(),this.translate.onLangChange.pipe(Object(o.a)(this.ngUnsubscribe)).subscribe(()=>{this.getTranslations()})}getTranslations(){this.translate.get("SETTINGS").pipe(Object(a.a)(1)).subscribe(e=>{this.options.langs=e.LANG_OPTIONS,this.options.themes=e.THEME_OPTIONS,this.options.renders=e.RENDER_OPTIONS,this.preselectOptions()})}preselectOptions(){this.form.lang=this.form.lang?this.form.lang:this.options.langs?Object.keys(this.options.langs)[0]:null,this.form.theme=this.form.theme?this.form.theme:this.options.themes?Object.keys(this.options.themes)[0]:null,this.form.render=this.form.render?this.form.render:this.options.renders?Object.keys(this.options.renders)[0]:null}autofillForm(){this.storage.getItem(this.storageKey).toPromise().then(e=>{e&&(this.form.player=e.player,this.form.playerId=e.playerId,this.form.lang=e.lang,this.form.theme=e.theme,this.form.render=e.render)})}optionChange(e,t){if("page"==this.mode)switch(t){case"lang":this.translate.use(e);break;case"theme":this.themeService.setActiveTheme(e)}}submit(){return Object(r.a)(this,void 0,void 0,function*(){if(!this.settingsForm.invalid){if("page"==this.mode){const e=yield this.userService.doCheckUser({user:this.form.player}).toPromise();this.form.playerId=e.userId}this.storage.saveItem(this.storageKey,this.form).subscribe(e=>{"page"==this.mode?this.route.navigateByUrl("arena"):(this.translate.use(e.lang),this.themeService.setActiveTheme(e.theme),this.saved.emit(!0))},e=>{console.error(e)})}})}ngOnDestroy(){this.ngUnsubscribe.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](c.a),i["\u0275\u0275directiveInject"](p.a),i["\u0275\u0275directiveInject"](d.d),i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](h))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-settings"]],viewQuery:function(e,t){if(1&e&&i["\u0275\u0275viewQuery"](y,1),2&e){let e;i["\u0275\u0275queryRefresh"](e=i["\u0275\u0275loadQuery"]())&&(t.settingsForm=e.first)}},inputs:{mode:"mode"},outputs:{saved:"saved"},decls:31,vars:32,consts:[[1,"form"],["settingsForm","ngForm"],[1,"form-item"],["for","player"],["type","text","name","player","required","",3,"ngModel","ngClass","ngModelChange",4,"ngIf","ngIfElse"],["modeModal",""],["for","lang"],["name","lang","id","","required","",3,"ngModel","ngClass","ngModelChange"],["lang","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","theme"],["name","theme","id","","required","",3,"ngModel","ngClass","ngModelChange"],["theme","ngModel"],[3,"text","disabled","emitter"],["type","text","name","player","required","",3,"ngModel","ngClass","ngModelChange"],["player","ngModel"],[3,"innerHtml"],[3,"value"]],template:function(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"h1"),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"form",0,1),i["\u0275\u0275elementStart"](5,"div",2),i["\u0275\u0275elementStart"](6,"label",3),i["\u0275\u0275text"](7),i["\u0275\u0275pipe"](8,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](9,S,2,4,"input",4),i["\u0275\u0275template"](10,E,1,1,"ng-template",null,5,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",2),i["\u0275\u0275elementStart"](13,"label",6),i["\u0275\u0275text"](14),i["\u0275\u0275pipe"](15,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](16,"select",7,8),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.form.lang=e})("ngModelChange",function(n){i["\u0275\u0275restoreView"](e);const r=i["\u0275\u0275reference"](17);return t.optionChange(n,r.name)}),i["\u0275\u0275template"](18,I,3,4,"option",9),i["\u0275\u0275pipe"](19,"keyvalue"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](20,"div",2),i["\u0275\u0275elementStart"](21,"label",10),i["\u0275\u0275text"](22),i["\u0275\u0275pipe"](23,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](24,"select",11,12),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.form.theme=e})("ngModelChange",function(n){i["\u0275\u0275restoreView"](e);const r=i["\u0275\u0275reference"](25);return t.optionChange(n,r.name)}),i["\u0275\u0275template"](26,C,3,4,"option",9),i["\u0275\u0275pipe"](27,"keyvalue"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](28,"div"),i["\u0275\u0275elementStart"](29,"app-ui-button",13),i["\u0275\u0275listener"]("emitter",function(){return t.submit()}),i["\u0275\u0275pipe"](30,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275reference"](4),n=i["\u0275\u0275reference"](11),r=i["\u0275\u0275reference"](17),s=i["\u0275\u0275reference"](25);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](2,14,"SETTINGS.title")),i["\u0275\u0275advance"](6),i["\u0275\u0275textInterpolate1"]("",i["\u0275\u0275pipeBind1"](8,16,"SETTINGS.player"),": "),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf","page"==t.mode)("ngIfElse",n),i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate1"]("",i["\u0275\u0275pipeBind1"](15,18,"SETTINGS.lang"),": "),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",t.form.lang)("ngClass",i["\u0275\u0275pureFunction1"](28,b,r.invalid&&(r.dirty||r.touched))),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",i["\u0275\u0275pipeBind1"](19,20,t.options.langs)),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"]("",i["\u0275\u0275pipeBind1"](23,22,"SETTINGS.theme"),": "),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngModel",t.form.theme)("ngClass",i["\u0275\u0275pureFunction1"](30,b,s.invalid&&(s.dirty||s.touched))),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",i["\u0275\u0275pipeBind1"](27,24,t.options.themes)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("text",i["\u0275\u0275pipeBind1"](30,26,"SETTINGS.button"))("disabled",e.invalid)}},directives:[f.l,f.d,f.e,g.k,f.j,f.i,f.c,f.f,g.i,g.j,v.a,f.a,f.g,f.k],pipes:[d.c,g.e],styles:[".form[_ngcontent-%COMP%]{margin:15px 0}"]}),e})()}}]);