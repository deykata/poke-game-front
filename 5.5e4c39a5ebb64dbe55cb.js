(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{uek7:function(e,t,n){"use strict";n.r(t),n.d(t,"VArenaModule",function(){return Se});var a=n("SVse"),o=n("iInd"),i=n("mrSG"),r=n("IzEk"),l=n("0np6"),s=n("8Y7J"),c=function(e){return e.Number="number",e.Object="object",e}({});let p=(()=>{class e{constructor(){}getRandomItems(e,t,n){let a=[];return new Array(t).fill(0).forEach(()=>{switch(n){case"number":a.push(Math.floor(Math.random()*e));break;case"object":a.push(e[Math.floor(Math.random()*e.length)])}}),a}filterArrays(e,t){return e.filter(e=>!t.includes(e))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class m{constructor(e,t,n,a,o){this.id=e,this.name=t,this.active=n,this.points=a,this.type=o}}class d{constructor(e,t,n){this.user=e,this.type=t,this.damage=n}}var g=n("IheW");let h=(()=>{class e{constructor(e){this.http=e}getPokemonCount(e){let t="?";if(e)for(let n of Object.keys(e))t=`${t+n}=${e[n]}`;return this.http.get(l.a.API_URL_POKEMON+l.a.P_POKEMON_FOLDER+t)}getPokemonById(e){return this.http.get(l.a.API_URL_POKEMON+l.a.P_POKEMON_FOLDER+"/"+e)}getPokemonMove(e){return this.http.get(e)}getPokemonType(e){return this.http.get(l.a.API_URL_POKEMON+l.a.P_TYPES_FOLDER+"/"+e)}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](g.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=n("fbMX");let f=(()=>{class e{constructor(e){this.http=e}buildUrl(e){return l.a.API_URL_WRAPPER+l.a.W_BATTLES_BASE+e}getBattleTypes(){return this.http.get(this.buildUrl(l.a.W_BATTLES_TYPES))}saveBattleResult(e){return this.http.post(this.buildUrl(l.a.W_BATTLES_NEW),e)}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](g.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class y{constructor(e,t,n,a,o,i,r,l,s){this.damageTaken=0,this.id=e,this.name=t.charAt(0).toUpperCase()+t.slice(1),this.hp=n,this.defense=a,this.attacks=l,this.type=i,this.typeRelations={noDamageFrom:r.damage_relations.no_damage_from,halfDamageFrom:r.damage_relations.half_damage_from,doubleDamageFrom:r.damage_relations.double_damage_from},this.image=o,this.moves=s,this.attacked=!1}}let v=(()=>{class e{constructor(e,t){this.utils=e,this.pokeApi=t}mapPokemon(e){return Object(i.a)(this,void 0,void 0,function*(){const t=this.utils.getRandomItems(e.moves,4,c.Object),n=this.utils.filterArrays(e.moves,t),a=e.types[0].type.name,o=yield this.pokeApi.getPokemonType(a).toPromise();return new y(e.id,e.name,e.stats[0].base_stat,e.stats[2].base_stat,e.sprites.other["official-artwork"].front_default,a,o,t,n)})}getAttackMultiplier(e,t){let n=1;for(const[a,o]of Object.entries(e))o.forEach(e=>{if(e.name===t)switch(a){case"doubleDamageFrom":n=2;break;case"halfDamageFrom":n=.5;break;case"noDamageFrom":n=0}});return n}addNewAttack(e,t){e.attacks=e.attacks.filter((e,n)=>n!=t);const n=this.utils.getRandomItems(e.moves,1,c.Object);return e.attacks=[...e.attacks,...n],e.moves=this.utils.filterArrays(e.moves,e.attacks),e}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](p),s["\u0275\u0275inject"](h))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var k=n("7JkF");let b=(()=>{class e{constructor(e){this.socket=e,this.rooms=this.socket.fromEvent("rooms"),this.receiveChallenge=this.socket.fromEvent("receiveChallenge"),this.battleAlert=this.socket.fromEvent("startBattle"),this.ongoingBattle=this.socket.fromEvent("ongoingBattle")}addRoom(e){this.socket.emit("addRoom",{id:this.roomId(),roomPlayer:e,available:!0})}sendChallenge(e,t){this.socket.emit("newChallenge",{playerId:e,challenger:t})}respondToChallenge(e,t,n){this.socket.emit("respondChallenge",{result:e,challenger:t,player:n})}updateBattle(e,t){this.socket.emit("updateBattle",{data:e,room:t})}endBattle(e){this.socket.emit("endBattle",e)}roomId(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](k.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function x(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",2),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().closeModal()}),s["\u0275\u0275elementEnd"]()}}function P(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",5),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).closeModal()}),s["\u0275\u0275text"](1,"+"),s["\u0275\u0275elementEnd"]()}}function S(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",3),s["\u0275\u0275template"](1,P,2,0,"button",4),s["\u0275\u0275projection"](2),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.closable)}}const C=["*"];let E=(()=>{class e{constructor(){this.closable=!0,this.close=new s.EventEmitter,this.show=!1}ngOnInit(){}ngOnChanges(e){e.trigger.currentValue!=e.trigger.previousValue&&(this.show=e.trigger.currentValue)}closeModal(){this.closable&&(this.show=!1,this.close.emit(!0))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-ui-modal"]],inputs:{trigger:"trigger",closable:"closable"},outputs:{close:"close"},features:[s["\u0275\u0275NgOnChangesFeature"]],ngContentSelectors:C,decls:2,vars:2,consts:[["class","bg",3,"click",4,"ngIf"],["class","modal",4,"ngIf"],[1,"bg",3,"click"],[1,"modal"],["class","close-btn",3,"click",4,"ngIf"],[1,"close-btn",3,"click"]],template:function(e,t){1&e&&(s["\u0275\u0275projectionDef"](),s["\u0275\u0275template"](0,x,1,0,"div",0),s["\u0275\u0275template"](1,S,3,1,"div",1)),2&e&&(s["\u0275\u0275property"]("ngIf",t.show),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.show))},directives:[a.k],styles:[".bg[_ngcontent-%COMP%]{width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.6);z-index:100}.bg[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{position:fixed}.modal[_ngcontent-%COMP%]{background:var(--background-light);border-radius:3px;box-shadow:0 0 5px 0 rgba(0,0,0,.2);padding:35px 40px;width:90%;max-width:600px;z-index:110;top:10%;left:50%;transform:translateX(-50%);max-height:80%;overflow:auto}.modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;border-radius:50%;right:10px;top:10px;color:grey;transform:rotate(45deg);width:24px;height:24px;background-color:initial;font-size:24px;line-height:0;cursor:pointer}"]}),e})();var M=n("tsYp"),O=n("XNiG"),I=n("1G5W");let w=(()=>{class e{constructor(e){this.http=e}buildUrl(e){let t;switch(e){case"battle":t=l.a.W_RANKINGS_BATTLE;break;case"player":t=l.a.W_RANKINGS_PLAYER;break;default:t=l.a.W_RANKINGS_COMBINED}return l.a.API_URL_WRAPPER+l.a.W_RANKINGS_BASE+t}getRanking(e,t,n){return this.http.get(this.buildUrl(e)+"?limit="+t+"&userId="+n)}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](g.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=n("TSSN"),B=n("s7LF");const A=function(e){return{flex:e}};function R(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"li",5),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("ngStyle",s["\u0275\u0275pureFunction1"](2,A,"1 0 "+100/n.data.headers.length+"%")),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](e)}}const T=function(e,t){return{flex:e,order:t}};function N(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"li",5),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"](2);s["\u0275\u0275property"]("ngStyle",s["\u0275\u0275pureFunction2"](2,T,"1 0 "+100/n.data.headers.length+"%",n.data.order.indexOf(e.key))),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](e.value)}}function j(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"ul"),s["\u0275\u0275template"](1,N,2,5,"li",2),s["\u0275\u0275pipe"](2,"keyvalue"),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",s["\u0275\u0275pipeBind1"](2,1,e))}}let D=(()=>{class e{constructor(){this.data={}}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-ui-table"]],inputs:{data:"data"},decls:6,vars:2,consts:[[1,"table"],[1,"thead"],[3,"ngStyle",4,"ngFor","ngForOf"],[1,"tbody"],[4,"ngFor","ngForOf"],[3,"ngStyle"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"ul"),s["\u0275\u0275template"](3,R,2,4,"li",2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"div",3),s["\u0275\u0275template"](5,j,3,3,"ul",4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",t.data.headers),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.data.body))},directives:[a.j,a.l],pipes:[a.e],styles:[".table[_ngcontent-%COMP%]   .thead[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{background-color:var(--primary-yellow);border-bottom:none}.table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;border-right:1px solid var(--primary-blue)}.table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--primary-blue)}.table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid var(--primary-blue)}.table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:nth-of-type(2n){background-color:azure}.table[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{border-left:1px solid var(--primary-blue);padding:5px 10px}.table[_ngcontent-%COMP%]   .tbody[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:nth-of-type(odd)   li[_ngcontent-%COMP%]{color:var(--text)}"]}),e})();function F(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span",9),s["\u0275\u0275elementStart"](1,"label",10),s["\u0275\u0275elementStart"](2,"input",11),s["\u0275\u0275listener"]("ngModelChange",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().selectedType=t})("ngModelChange",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().getRanking()}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](3),s["\u0275\u0275pipe"](4,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("for",e.name),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("value",e.type)("ngModel",n.selectedType)("name",e.name)("id",e.name),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("",s["\u0275\u0275pipeBind1"](4,6,"RANKINGS."+e.name.toLowerCase())," ")}}let H=(()=>{class e{constructor(e,t,n){this.rankingService=e,this.storage=t,this.translate=n,this.ngUnsubscribe=new O.a,this.rankingData={},this.rankingLimit=10,this.rankingTypes=[{type:"combined",name:"Combined"},{type:"player",name:"Player"},{type:"battle",name:"Battle"}]}ngOnInit(){this.selectedType=this.rankingTypes[0].type,this.getUserData()}subscribeToTranslations(){this.translate.onLangChange.pipe(Object(I.a)(this.ngUnsubscribe)).subscribe(()=>{this.getTranslations()})}getTranslations(){this.translate.get("RANKINGS").pipe(Object(r.a)(1)).subscribe(e=>{this.rankingData.headers=[e.position,e.player,e.points]})}getUserData(){this.storage.getItem(l.b.DB_SETTINGS).toPromise().then(e=>{this.playerId=e.playerId,this.getRanking()})}getRanking(){this.rankingService.getRanking(this.selectedType,this.rankingLimit,this.playerId).toPromise().then(e=>{this.getTranslations(),this.rankingData.body=e.rankings,this.rankingData.order=["position","player","points"]})}ngOnDestroy(){this.ngUnsubscribe.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](w),s["\u0275\u0275directiveInject"](u.a),s["\u0275\u0275directiveInject"](_.d))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-rankings"]],decls:17,vars:9,consts:[[1,"radio-wrapper"],["class","radio-item",4,"ngFor","ngForOf"],[1,"form-item","limit"],["for","limit"],["name","limit","id","",3,"ngModel","ngModelChange"],["value","10"],["value","20"],["value","50"],[3,"data"],[1,"radio-item"],[3,"for"],["type","radio",3,"value","ngModel","name","id","ngModelChange"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"h1"),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"div",0),s["\u0275\u0275template"](4,F,5,8,"span",1),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",2),s["\u0275\u0275elementStart"](6,"label",3),s["\u0275\u0275text"](7),s["\u0275\u0275pipe"](8,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"select",4),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.rankingLimit=e})("ngModelChange",function(){return t.getRanking()}),s["\u0275\u0275elementStart"](10,"option",5),s["\u0275\u0275text"](11,"10"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"option",6),s["\u0275\u0275text"](13,"20"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"option",7),s["\u0275\u0275text"](15,"50"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](16,"app-ui-table",8)),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](2,5,"RANKINGS.title")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",t.rankingTypes),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",s["\u0275\u0275pipeBind1"](8,7,"RANKINGS.limitTxt")," "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngModel",t.rankingLimit),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("data",t.rankingData))},directives:[a.j,B.j,B.c,B.f,B.g,B.k,D,B.h,B.a],pipes:[_.c],styles:[".limit[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:auto;margin-right:5px}.radio-wrapper[_ngcontent-%COMP%]{padding:10px 0}"]}),e})();function V(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"app-settings",7),s["\u0275\u0275listener"]("saved",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().toggleModal("settings")}),s["\u0275\u0275elementEnd"]()}}function L(e,t){1&e&&s["\u0275\u0275element"](0,"app-rankings")}let z=(()=>{class e{constructor(e,t){this.storage=e,this.route=t}ngOnInit(){}toggleModal(e){switch(this.showModal=!this.showModal,e){case"settings":this.showSettings=!this.showSettings;break;case"rankings":this.showRankings=!this.showRankings;break;default:this.showRankings=null,this.showSettings=null,this.showModal=!1}}signOut(){this.storage.clear().toPromise().then(()=>{this.route.navigateByUrl("settings")})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](u.a),s["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-header"]],decls:18,vars:12,consts:[[1,"view","header"],[1,"logo"],[1,"menu"],["href","javascript:void(0)",3,"click"],[3,"trigger","close"],[3,"saved",4,"ngIf"],[4,"ngIf"],[3,"saved"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"header",0),s["\u0275\u0275element"](1,"div",1),s["\u0275\u0275elementStart"](2,"ul",2),s["\u0275\u0275elementStart"](3,"li"),s["\u0275\u0275elementStart"](4,"a",3),s["\u0275\u0275listener"]("click",function(){return t.toggleModal("rankings")}),s["\u0275\u0275text"](5),s["\u0275\u0275pipe"](6,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"li"),s["\u0275\u0275elementStart"](8,"a",3),s["\u0275\u0275listener"]("click",function(){return t.toggleModal("settings")}),s["\u0275\u0275text"](9),s["\u0275\u0275pipe"](10,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"li"),s["\u0275\u0275elementStart"](12,"a",3),s["\u0275\u0275listener"]("click",function(){return t.signOut()}),s["\u0275\u0275text"](13),s["\u0275\u0275pipe"](14,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"app-ui-modal",4),s["\u0275\u0275listener"]("close",function(){return t.toggleModal("modal")}),s["\u0275\u0275template"](16,V,1,0,"app-settings",5),s["\u0275\u0275template"](17,L,1,0,"app-rankings",6),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](6,6,"HEADER.rankings")),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](10,8,"HEADER.settings")),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](14,10,"HEADER.signOut")),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("trigger",t.showModal),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.showSettings),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.showRankings))},directives:[E,a.k,M.a,H],pipes:[_.c],styles:[".header[_ngcontent-%COMP%]{padding-top:15px;display:flex;justify-content:space-between}.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--secondary-blue);text-decoration:none}.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.header[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;margin-left:20px}"]}),e})();function U(e,t){1&e&&(s["\u0275\u0275element"](0,"span",5),s["\u0275\u0275pipe"](1,"translate")),2&e&&s["\u0275\u0275property"]("innerHTML",s["\u0275\u0275pipeBind1"](1,1,"ARENA.battleResultWon"),s["\u0275\u0275sanitizeHtml"])}function W(e,t){1&e&&(s["\u0275\u0275element"](0,"span",5),s["\u0275\u0275pipe"](1,"translate")),2&e&&s["\u0275\u0275property"]("innerHTML",s["\u0275\u0275pipeBind1"](1,1,"ARENA.battleResultLost"),s["\u0275\u0275sanitizeHtml"])}const G=["*"];let K=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-battle-result"]],inputs:{result:"result"},ngContentSelectors:G,decls:7,vars:2,consts:[[1,"result"],[1,"msg"],[3,"innerHTML",4,"ngIf","ngIfElse"],["lost",""],[1,"btn-wrapper"],[3,"innerHTML"]],template:function(e,t){if(1&e&&(s["\u0275\u0275projectionDef"](),s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"p",1),s["\u0275\u0275template"](2,U,2,3,"span",2),s["\u0275\u0275template"](3,W,2,3,"ng-template",null,3,s["\u0275\u0275templateRefExtractor"]),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",4),s["\u0275\u0275projection"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](4);s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.result)("ngIfElse",e)}},directives:[a.k],pipes:[_.c],styles:[".result[_ngcontent-%COMP%]{text-align:center}.result[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{color:var(--primary-blue);font-size:34px;font-weight:700;font-style:italic;padding:25px 0}"]}),e})();var $=n("7drl");let Y=(()=>{class e{constructor(){this.challengeResult=new s.EventEmitter}ngOnInit(){}challengeResponse(e){this.challengeResult.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-battle-challenge"]],inputs:{challenger:"challenger"},outputs:{challengeResult:"challengeResult"},decls:8,vars:1,consts:[[1,"challenge"],[1,"title"],[1,"msg","themed"],[1,"btns-wrapper"],["text","Decline",3,"emitter"],["text","Accept",3,"emitter"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"p",1),s["\u0275\u0275text"](2,"Battle challenge"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"p",2),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",3),s["\u0275\u0275elementStart"](6,"app-ui-button",4),s["\u0275\u0275listener"]("emitter",function(){return t.challengeResponse(!1)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"app-ui-button",5),s["\u0275\u0275listener"]("emitter",function(){return t.challengeResponse(!0)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("",t.challenger," is challenging you to a battle!"))},directives:[$.a],styles:[".challenge[_ngcontent-%COMP%]{text-align:center}.challenge[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--primary-blue);font-size:34px;font-weight:700;font-style:italic;padding:5px 0 10px}.challenge[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{padding-bottom:30px}.challenge[_ngcontent-%COMP%]   app-ui-button[_ngcontent-%COMP%]{margin:0 5px}"]}),e})();function J(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",7),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const t=s["\u0275\u0275nextContext"]().$implicit;return s["\u0275\u0275nextContext"]().challangePlayer(t)}),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275property"]("disabled",!e.available),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](e.roomPlayer)}}function X(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"li"),s["\u0275\u0275template"](1,J,2,2,"button",6),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",n.player!=e.roomPlayer)}}function Z(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"p",8),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](2,1,"ARENA.onlineRoomNone")))}let q=(()=>{class e{constructor(e,t){this.onlineService=e,this.storage=t,this.acceptedBattle=new s.EventEmitter,this.rooms=[],this.subscriptions=[]}ngOnInit(){this.storage.getItem(l.b.DB_SETTINGS).pipe(Object(r.a)(1)).subscribe(e=>{this.player=e.player,this.onlineService.addRoom(this.player);const t=this.onlineService.rooms.subscribe(e=>{this.rooms=e}),n=this.onlineService.receiveChallenge.subscribe(e=>{this.challenger=e,this.showModal=!0}),a=this.onlineService.battleAlert.subscribe(e=>{this.acceptedBattle.emit(e)});this.subscriptions=[t,n,a]})}ngOnDestroy(){this.subscriptions.forEach(e=>{e.unsubscribe()})}challangePlayer(e){e.available&&this.onlineService.sendChallenge(e.id,this.player)}respondToChallenge(e){this.onlineService.respondToChallenge(e,this.challenger,this.player),this.showModal=!1}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](b),s["\u0275\u0275directiveInject"](u.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-online-room"]],outputs:{acceptedBattle:"acceptedBattle"},decls:9,vars:8,consts:[[1,"online-room"],[1,"rooms-wrapper"],[4,"ngFor","ngForOf"],["class","themed",4,"ngIf"],[3,"trigger","closable"],[3,"challenger","challengeResult"],["class","room",3,"disabled","click",4,"ngIf"],[1,"room",3,"disabled","click"],[1,"themed"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"h1"),s["\u0275\u0275text"](2),s["\u0275\u0275pipe"](3,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"ul",1),s["\u0275\u0275template"](5,X,2,1,"li",2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](6,Z,3,3,"p",3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"app-ui-modal",4),s["\u0275\u0275elementStart"](8,"app-battle-challenge",5),s["\u0275\u0275listener"]("challengeResult",function(e){return t.respondToChallenge(e)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](3,6,"ARENA.onlineRoom")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",t.rooms),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",1==t.rooms.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("trigger",t.showModal)("closable",!1),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("challenger",t.challenger))},directives:[a.j,a.k,E,Y],pipes:[_.c],styles:[".rooms-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.rooms-wrapper[_ngcontent-%COMP%]   .room[_ngcontent-%COMP%]{display:block;padding:10px 20px;background:azure;margin-right:10px;cursor:pointer}.rooms-wrapper[_ngcontent-%COMP%]   .room[_ngcontent-%COMP%]:hover{background:#e6e6fa}.rooms-wrapper[_ngcontent-%COMP%]   .room[_ngcontent-%COMP%]:disabled{cursor:not-allowed}"]}),e})();function Q(e,t){if(1&e&&s["\u0275\u0275element"](0,"p",5),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("innerHtml",e.title,s["\u0275\u0275sanitizeHtml"])}}function ee(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",12),s["\u0275\u0275elementStart"](1,"p",13),s["\u0275\u0275text"](2),s["\u0275\u0275pipe"](3,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"p",13),s["\u0275\u0275text"](5),s["\u0275\u0275pipe"](6,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate2"]("",s["\u0275\u0275pipeBind1"](3,4,"ARENA.type"),": ",e.pokemon.type,""),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate2"]("",s["\u0275\u0275pipeBind1"](6,6,"ARENA.multiplier"),": ",e.pokemon.attackMultiplier,"")}}function te(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275elementStart"](1,"div",7),s["\u0275\u0275element"](2,"span",8),s["\u0275\u0275elementStart"](3,"span",9),s["\u0275\u0275listener"]("mouseover",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().infoModal=!0})("mouseout",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().infoModal=!1}),s["\u0275\u0275text"](4,"i"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](5,ee,7,8,"div",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](6,"p",11),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("innerHtml",e.pokemon.name,s["\u0275\u0275sanitizeHtml"]),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",e.infoModal),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("innerHtml","HP: "+e.pokemon.hp,s["\u0275\u0275sanitizeHtml"])}}const ne=function(e,t){return{blue:e,attacked:t}};let ae=(()=>{class e{constructor(){this.infoModal=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-battle-card"]],inputs:{title:"title",pokemon:"pokemon",type:"type"},decls:5,vars:8,consts:[[1,"card",3,"ngClass"],["class","title",3,"innerHtml",4,"ngIf"],["class","pokemon-data",4,"ngIf"],[1,"pokemon-visual"],[3,"src","alt"],[1,"title",3,"innerHtml"],[1,"pokemon-data"],[1,"pokemon-data--name"],[3,"innerHtml"],[1,"info",3,"mouseover","mouseout"],["class","info-modal",4,"ngIf"],[1,"pokemon-data--hp",3,"innerHtml"],[1,"info-modal"],[1,"themed"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275template"](1,Q,1,1,"p",1),s["\u0275\u0275template"](2,te,7,3,"div",2),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275element"](4,"img",4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction2"](5,ne,"blue"===t.type,t.pokemon.attacked)),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.title),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.pokemon),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("src",t.pokemon.image,s["\u0275\u0275sanitizeUrl"])("alt",t.pokemon.name))},directives:[a.i,a.k],pipes:[_.c],styles:[".pokemon-data[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:15px;font-weight:600}@media (max-width:500px){.pokemon-data[_ngcontent-%COMP%]{display:block;text-align:left}}.pokemon-data--name[_ngcontent-%COMP%]{position:relative}.pokemon-visual[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:.2s}.info-modal[_ngcontent-%COMP%]{position:absolute;top:150%;left:calc(100% - 18px);background:var(--background-light);border-radius:3px;box-shadow:0 0 5px 0 rgba(0,0,0,.1);padding:10px 15px;width:200px;text-align:left}@media (max-width:500px){.info-modal[_ngcontent-%COMP%]{width:100%;left:0;top:110%}}.info-modal[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:400;margin:3px 0 5px;text-transform:capitalize}.attacked[_ngcontent-%COMP%]{background-color:red}.attacked[_ngcontent-%COMP%]   .pokemon-visual[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(.95)}.info[_ngcontent-%COMP%]{display:inline-block;text-align:center;width:18px;height:18px;border:2px solid grey;border-radius:50%;font-size:12px;vertical-align:bottom;color:grey;margin-left:3px;font-style:italic;font-family:initial;cursor:help}"]}),e})();function oe(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"span",15),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" <- ",s["\u0275\u0275pipeBind1"](2,1,"ARENA.comingSoon"),""))}function ie(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"li"),s["\u0275\u0275elementStart"](1,"app-ui-button",14),s["\u0275\u0275listener"]("emitter",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"](2).battleSelected(n)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](2,oe,3,3,"span",4),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("text",e.name)("disabled",!e.active),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!e.active)}}function re(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",12),s["\u0275\u0275elementStart"](1,"h1"),s["\u0275\u0275text"](2),s["\u0275\u0275pipe"](3,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"ul"),s["\u0275\u0275template"](5,ie,3,3,"li",13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](3,2,"ARENA.preStage")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",e.battleTypes)}}function le(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"app-online-room",16),s["\u0275\u0275listener"]("acceptedBattle",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().prepareOnlineBattle(t)}),s["\u0275\u0275elementEnd"]()}}function se(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"h1"),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](2,1,"ARENA.title")))}function ce(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"p",15),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](2,1,"ARENA.progressStage0")))}function pe(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"a",20),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).selectPokemon(n)}),s["\u0275\u0275elementStart"](1,"span",21),s["\u0275\u0275element"](2,"img",22),s["\u0275\u0275elementStart"](3,"span"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("src",e.image,s["\u0275\u0275sanitizeUrl"])("alt",e.name),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](e.name)}}function me(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",17),s["\u0275\u0275elementStart"](1,"h2"),s["\u0275\u0275text"](2),s["\u0275\u0275pipe"](3,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"div",18),s["\u0275\u0275template"](5,pe,5,3,"a",19),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](3,2,"ARENA.progressStage1")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",e.selectedPokemons)}}function de(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"p",15),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](2,1,"ARENA.waitingOpponent")))}function ge(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",23),s["\u0275\u0275elementStart"](1,"div",18),s["\u0275\u0275elementStart"](2,"div",24),s["\u0275\u0275elementStart"](3,"div",25),s["\u0275\u0275element"](4,"app-battle-card",26),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",24),s["\u0275\u0275elementStart"](6,"div",27),s["\u0275\u0275element"](7,"app-battle-card",28),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("title",e.player)("pokemon",e.playerPokemon),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("title",e.enemyName?e.enemyName:"COM")("pokemon",e.enemyPokemon)}}function he(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"li",24),s["\u0275\u0275elementStart"](1,"app-ui-button",37),s["\u0275\u0275listener"]("emitter",function(){s["\u0275\u0275restoreView"](e);const n=t.index,a=t.$implicit;return s["\u0275\u0275nextContext"](3).launchAttack(n,a,"player")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("text",e.move.name)("full",!0)}}const ue=function(e){return{name:e}};function fe(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",18),s["\u0275\u0275element"](1,"p",34),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementStart"](3,"ul",35),s["\u0275\u0275template"](4,he,2,2,"li",36),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("innerHTML",s["\u0275\u0275pipeBind2"](2,2,"ARENA.playerTurnMsg",s["\u0275\u0275pureFunction1"](5,ue,e.playerPokemon.name)),s["\u0275\u0275sanitizeHtml"]),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",e.playerPokemon.attacks)}}function ye(e,t){if(1&e&&(s["\u0275\u0275element"](0,"p",38),s["\u0275\u0275pipe"](1,"translate")),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275property"]("innerHTML",s["\u0275\u0275pipeBind2"](1,1,"ARENA.enemyTurnMsg",s["\u0275\u0275pureFunction1"](4,ue,e.enemyPokemon.name)),s["\u0275\u0275sanitizeHtml"])}}function ve(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",29),s["\u0275\u0275elementStart"](1,"div",30),s["\u0275\u0275elementStart"](2,"div",31),s["\u0275\u0275template"](3,fe,5,7,"div",32),s["\u0275\u0275template"](4,ye,2,6,"ng-template",null,33,s["\u0275\u0275templateRefExtractor"]),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](5),t=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",t.playerTurn)("ngIfElse",e)}}function ke(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",39),s["\u0275\u0275elementStart"](1,"app-ui-button",11),s["\u0275\u0275listener"]("emitter",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().restartArena()}),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("text",s["\u0275\u0275pipeBind1"](2,1,"ARENA.reload")))}const be=[{path:"",component:(()=>{class e{constructor(e,t,n,a,o,i){this.pokeApi=e,this.storage=t,this.utils=n,this.battleService=a,this.pokemonHelper=o,this.onlineService=i,this.battleTypes=[],this.selectedPokemonIds=[],this.selectedPokemons=[],this.playerPokemon={},this.enemyPokemon={},this.progressStage=-1,this.opponentWaiting=!1,this.onlineBattle={startingPlayer:null,enemyPokemon:null,enemyName:null,attackData:null}}unloadHandler(e){this.progressStage>1&&(e.returnValue=!1),e.preventDefault()}ngOnInit(){this.loadBattleTypes(),this.getUserData()}loadBattleTypes(){this.battleService.getBattleTypes().toPromise().then(e=>{e.types.forEach(e=>{const t=new m(e.id,e.name,e.active,e.points,e.type);this.battleTypes.push(t)})})}getUserData(){this.storage.getItem(l.b.DB_SETTINGS).toPromise().then(e=>{this.player=e.player})}battleSelected(e){switch(this.selectedBattleType=e,this.selectedBattleType.type){case"solo":this.prepareArena();break;case"online":this.progressStage=null,this.subscribeToBattle()}}prepareOnlineBattle(e){console.log("me",e),this.battleSocket=e,this.prepareArena()}restartArena(){this.progressStage=-1,this.selectedPokemons=[],this.selectedPokemonIds=[],this.showModal=null}prepareArena(){this.progressStage=0,this.pokeApi.getPokemonCount({limit:1}).pipe(Object(r.a)(1)).subscribe(e=>{this.pokemonCount=e.count,this.selectedPokemonIds=this.utils.getRandomItems(850,2,c.Number),this.getSelectedPokemonsData()})}getSelectedPokemonsData(){let e=[];this.selectedPokemonIds.forEach(t=>{e.push(()=>this.pokeApi.getPokemonById(t+1).toPromise())}),Promise.all(e.map(e=>e())).then(e=>{e.forEach(e=>Object(i.a)(this,void 0,void 0,function*(){if(e.moves.length){const t=yield this.pokemonHelper.mapPokemon(e);this.selectedPokemons.push(t)}else this.getNewPokemon()})),this.progressStage=1}).catch(e=>{this.getNewPokemon()})}getNewPokemon(){const e=this.utils.getRandomItems(850,1,c.Number)[0]+1;this.pokeApi.getPokemonById(e).toPromise().then(e=>Object(i.a)(this,void 0,void 0,function*(){if(e.moves.length){const t=yield this.pokemonHelper.mapPokemon(e);this.selectedPokemons.push(t),this.progressStage=1}else this.getNewPokemon()}))}selectPokemon(e){this.playerPokemon=this.selectedPokemons[e],this.playerPokemon.attackMultiplier=this.pokemonHelper.getAttackMultiplier(this.playerPokemon.typeRelations,this.enemyPokemon.type),"solo"==this.selectedBattleType.type&&(this.enemyPokemon=this.selectedPokemons.find((t,n)=>n!=e),this.enemyPokemon.attackMultiplier=this.pokemonHelper.getAttackMultiplier(this.enemyPokemon.typeRelations,this.playerPokemon.type),this.startBattle()),"online"==this.selectedBattleType.type&&(this.opponentWaiting=!0,this.enemyPokemon.id||(this.onlineBattle.startingPlayer=this.player),this.onlineBattle.enemyName=this.player,this.onlineBattle.enemyPokemon=this.playerPokemon,this.onlineService.updateBattle(this.onlineBattle,this.battleSocket),this.checkOnlineBattle())}subscribeToBattle(){this.onlineService.ongoingBattle.subscribe(e=>{const t=e;this.enemyPokemon=t.enemyPokemon,this.enemyName=t.enemyName,this.progressStage&&this.progressStage<2&&this.checkOnlineBattle(),t.attackData&&this.applyDamage(this.playerPokemon,t.attackData,this.playerPokemon.attackMultiplier)})}checkOnlineBattle(){this.enemyPokemon.id&&this.playerPokemon.id&&(this.opponentWaiting=!1,this.startBattle())}startBattle(){this.progressStage=2,this.playerTurn=!0,"online"==this.selectedBattleType.type&&this.onlineBattle.startingPlayer!=this.player&&(this.playerTurn=!1)}launchAttack(e,t,n){return Object(i.a)(this,void 0,void 0,function*(){const a=yield this.pokeApi.getPokemonMove(t.move.url).toPromise();let o=this.playerPokemon,i=this.enemyPokemon;"enemy"===n&&(o=this.enemyPokemon,i=this.playerPokemon),this.applyDamage(i,a,o.attackMultiplier),o=this.pokemonHelper.addNewAttack(o,e),"online"==this.selectedBattleType.type&&(this.onlineBattle.attackData=a,this.onlineService.updateBattle(this.onlineBattle,this.battleSocket))})}applyDamage(e,t,n){e.hp=e.hp-t.power*n,e.damageTaken=e.damageTaken+t.power*n,e.attacked=!0,this.playerTurn=!this.playerTurn,setTimeout(()=>{e.attacked=!1},200),e.hp<=0?this.showResultModal():this.checkTurn()}checkTurn(){this.playerTurn||"solo"!=this.selectedBattleType.type||setTimeout(()=>{const e=this.utils.getRandomItems(this.enemyPokemon.attacks,1,c.Object)[0],t=this.enemyPokemon.attacks.findIndex(t=>t.move.name==e.move.name);this.launchAttack(t,e,"enemy")},1e3)}showResultModal(){return Object(i.a)(this,void 0,void 0,function*(){this.progressStage=3,setTimeout(()=>{this.showModal=!this.showModal},500);const e=yield new d(this.player,this.selectedBattleType.id,this.enemyPokemon.damageTaken);this.battleService.saveBattleResult(e).toPromise().then(e=>{console.log(e),this.onlineService.endBattle(this.battleSocket)})})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](h),s["\u0275\u0275directiveInject"](u.a),s["\u0275\u0275directiveInject"](p),s["\u0275\u0275directiveInject"](f),s["\u0275\u0275directiveInject"](v),s["\u0275\u0275directiveInject"](b))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-v-arena"]],hostBindings:function(e,t){1&e&&s["\u0275\u0275listener"]("beforeunload",function(e){return t.unloadHandler(e)},!1,s["\u0275\u0275resolveWindow"])},decls:15,vars:15,consts:[[1,"view","page"],["class","battle-selection",4,"ngIf"],[3,"acceptedBattle",4,"ngIf"],[4,"ngIf"],["class","themed",4,"ngIf"],["class","pokemon-selection",4,"ngIf"],["class","pokemon-battle",4,"ngIf"],["class","pokemon-actions",4,"ngIf"],["class","restart-arena",4,"ngIf"],[3,"trigger","closable"],[3,"result"],[3,"text","emitter"],[1,"battle-selection"],[4,"ngFor","ngForOf"],[3,"text","disabled","emitter"],[1,"themed"],[3,"acceptedBattle"],[1,"pokemon-selection"],[1,"grid"],["class","grid--item col6 pgr-item","href","javascript:void(0);",3,"click",4,"ngFor","ngForOf"],["href","javascript:void(0);",1,"grid--item","col6","pgr-item",3,"click"],[1,"inner"],[3,"src","alt"],[1,"pokemon-battle"],[1,"grid--item","col6"],[1,"pokemon","player"],[3,"title","pokemon"],[1,"pokemon","enemy"],["type","blue",3,"title","pokemon"],[1,"pokemon-actions"],[1,"card"],[1,"actions"],["class","grid",4,"ngIf","ngIfElse"],["playerWaiting",""],[1,"grid--item","col6","mob-col12",3,"innerHTML"],[1,"grid--item","col6","mob-col12","grid"],["class","grid--item col6",4,"ngFor","ngForOf"],[3,"text","full","emitter"],[1,"waiting",3,"innerHTML"],[1,"restart-arena"]],template:function(e,t){1&e&&(s["\u0275\u0275element"](0,"app-header"),s["\u0275\u0275elementStart"](1,"div",0),s["\u0275\u0275template"](2,re,6,4,"div",1),s["\u0275\u0275template"](3,le,1,0,"app-online-room",2),s["\u0275\u0275template"](4,se,3,3,"h1",3),s["\u0275\u0275template"](5,ce,3,3,"p",4),s["\u0275\u0275template"](6,me,6,4,"div",5),s["\u0275\u0275template"](7,de,3,3,"p",4),s["\u0275\u0275template"](8,ge,8,4,"div",6),s["\u0275\u0275template"](9,ve,6,2,"div",7),s["\u0275\u0275template"](10,ke,3,3,"div",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"app-ui-modal",9),s["\u0275\u0275elementStart"](12,"app-battle-result",10),s["\u0275\u0275elementStart"](13,"app-ui-button",11),s["\u0275\u0275listener"]("emitter",function(){return t.restartArena()}),s["\u0275\u0275pipe"](14,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",-1==t.progressStage),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",null==t.progressStage),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.progressStage>0),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",0==t.progressStage),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",1==t.progressStage&&!t.opponentWaiting),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.opponentWaiting),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.progressStage>=2),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",2==t.progressStage),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",1==t.progressStage&&"solo"==t.selectedBattleType.type),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("trigger",t.showModal)("closable",!1),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("result",t.playerPokemon.hp>0),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("text",s["\u0275\u0275pipeBind1"](14,13,"ARENA.reload")))},directives:[z,a.k,E,K,$.a,a.j,q,ae],pipes:[_.c],styles:[".pgr-item[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{background-color:azure;display:block;padding-bottom:10px}.pgr-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:20px;color:grey}.pgr-item[_ngcontent-%COMP%]:hover   .inner[_ngcontent-%COMP%]{background-color:#e6e6fa}.pokemon-actions[_ngcontent-%COMP%]{margin-top:10px}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p.waiting[_ngcontent-%COMP%]{text-align:right}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .single-action[_ngcontent-%COMP%]{width:100%}.restart-arena[_ngcontent-%COMP%]{margin-top:50px;text-align:center}"]}),e})()}];let xe=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.b.forChild(be)],o.b]}),e})();var Pe=n("j1ZV");let Se=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b,xe,_.b,Pe.a]]}),e})()}}]);