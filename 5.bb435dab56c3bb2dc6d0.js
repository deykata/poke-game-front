(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{uek7:function(e,t,n){"use strict";n.r(t),n.d(t,"VArenaModule",function(){return K});var o=n("SVse"),a=n("iInd");function r(e,t,n,o){return new(n||(n=Promise))(function(a,r){function i(e){try{l(o.next(e))}catch(t){r(t)}}function s(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,s)}l((o=o.apply(e,t||[])).next())})}var i=n("IzEk");class s{constructor(e,t,n,o,a,r,i,s){this.name=e.charAt(0).toUpperCase()+e.slice(1),this.hp=t,this.defense=n,this.attacks=i,this.type=a,this.typeRelations={noDamageFrom:r.damage_relations.no_damage_from,halfDamageFrom:r.damage_relations.half_damage_from,doubleDamageFrom:r.damage_relations.double_damage_from},this.image=o,this.moves=s,this.attacked=!1}}var l=n("0np6"),p=n("8Y7J"),c=function(e){return e.Number="number",e.Object="object",e}({});let m=(()=>{class e{constructor(){}getRandomItems(e,t,n){let o=[];return new Array(t).fill(0).forEach(()=>{switch(n){case"number":o.push(Math.floor(Math.random()*e));break;case"object":o.push(e[Math.floor(Math.random()*e.length)])}}),o}filterArrays(e,t){return e.filter(e=>!t.includes(e))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=p["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=n("IheW");let g=(()=>{class e{constructor(e){this.http=e}getPokemonCount(e){let t="?";if(e)for(let n of Object.keys(e))t=`${t+n}=${e[n]}`;return this.http.get(l.a.POKEMON_API_URL+l.a.POKEMON_FOLDER+t)}getPokemonById(e){return this.http.get(l.a.POKEMON_API_URL+l.a.POKEMON_FOLDER+e)}getPokemonMove(e){return this.http.get(e)}getPokemonType(e){return this.http.get(l.a.POKEMON_API_URL+l.a.TYPES_FOLDER+e)}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275inject"](d.a))},e.\u0275prov=p["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=n("fbMX");function h(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",1),p["\u0275\u0275elementStart"](1,"div",2),p["\u0275\u0275elementStart"](2,"button",3),p["\u0275\u0275listener"]("click",function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().closeModal()}),p["\u0275\u0275text"](3,"+"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275projection"](4),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}}const f=["*"];let k=(()=>{class e{constructor(){this.close=new p.EventEmitter,this.show=!1}ngOnInit(){}ngOnChanges(e){e.trigger.currentValue!=e.trigger.previousValue&&(this.show=!this.show)}closeModal(){this.show=!1,this.close.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-ui-modal"]],inputs:{trigger:"trigger"},outputs:{close:"close"},features:[p["\u0275\u0275NgOnChangesFeature"]],ngContentSelectors:f,decls:1,vars:1,consts:[["class","bg",4,"ngIf"],[1,"bg"],[1,"modal"],[1,"close-btn",3,"click"]],template:function(e,t){1&e&&(p["\u0275\u0275projectionDef"](),p["\u0275\u0275template"](0,h,5,0,"div",0)),2&e&&p["\u0275\u0275property"]("ngIf",t.show)},directives:[o.k],styles:[".bg[_ngcontent-%COMP%]{width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.6);z-index:100}.bg[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{position:fixed}.modal[_ngcontent-%COMP%]{background:var(--background-light);border-radius:3px;box-shadow:0 0 5px 0 rgba(0,0,0,.2);padding:15px 25px;width:90%;max-width:600px;top:10%;left:50%;transform:translateX(-50%)}.modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;border-radius:50%;right:10px;top:10px;color:grey;transform:rotate(45deg);width:24px;height:24px;background-color:initial;font-size:24px;line-height:0;cursor:pointer}"]}),e})();var v=n("tsYp"),y=n("TSSN");let P=(()=>{class e{constructor(e,t){this.storage=e,this.route=t}ngOnInit(){}toggleSettings(){this.showSettings=!this.showSettings}signOut(){this.storage.clear().toPromise().then(()=>{this.route.navigateByUrl("settings")})}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](u.a),p["\u0275\u0275directiveInject"](a.a))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-header"]],decls:9,vars:7,consts:[[1,"view","header"],["href","javascript:void(0)",3,"click"],[3,"trigger"],[3,"saved"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"header",0),p["\u0275\u0275elementStart"](1,"a",1),p["\u0275\u0275listener"]("click",function(){return t.toggleSettings()}),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"a",1),p["\u0275\u0275listener"]("click",function(){return t.signOut()}),p["\u0275\u0275text"](5),p["\u0275\u0275pipe"](6,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](7,"app-ui-modal",2),p["\u0275\u0275elementStart"](8,"app-settings",3),p["\u0275\u0275listener"]("saved",function(){return t.toggleSettings()}),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](3,3,"HEADER.settings")),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](6,5,"HEADER.signOut")),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("trigger",t.showSettings))},directives:[k,v.a],pipes:[y.c],styles:[".header[_ngcontent-%COMP%]{padding-top:15px;display:flex;justify-content:space-between}.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#3d5aa6;text-decoration:none}.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}),e})();function x(e,t){1&e&&(p["\u0275\u0275element"](0,"span",5),p["\u0275\u0275pipe"](1,"translate")),2&e&&p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](1,1,"ARENA.battleResultWon"),p["\u0275\u0275sanitizeHtml"])}function M(e,t){1&e&&(p["\u0275\u0275element"](0,"span",5),p["\u0275\u0275pipe"](1,"translate")),2&e&&p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](1,1,"ARENA.battleResultLost"),p["\u0275\u0275sanitizeHtml"])}const b=["*"];let E=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-battle-result"]],inputs:{result:"result"},ngContentSelectors:b,decls:7,vars:2,consts:[[1,"result"],[1,"msg"],[3,"innerHTML",4,"ngIf","ngIfElse"],["lost",""],[1,"btn-wrapper"],[3,"innerHTML"]],template:function(e,t){if(1&e&&(p["\u0275\u0275projectionDef"](),p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275elementStart"](1,"p",1),p["\u0275\u0275template"](2,x,2,3,"span",2),p["\u0275\u0275template"](3,M,2,3,"ng-template",null,3,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](5,"div",4),p["\u0275\u0275projection"](6),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275reference"](4);p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",t.result)("ngIfElse",e)}},directives:[o.k],pipes:[y.c],styles:[".result[_ngcontent-%COMP%]{text-align:center}.result[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{color:#3d5aa6;font-size:34px;font-weight:700;font-style:italic;padding:25px 0}"]}),e})();var C=n("7drl");function O(e,t){if(1&e&&p["\u0275\u0275element"](0,"p",5),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275property"]("innerHtml",e.title,p["\u0275\u0275sanitizeHtml"])}}function w(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",12),p["\u0275\u0275elementStart"](1,"p"),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"p"),p["\u0275\u0275text"](5),p["\u0275\u0275pipe"](6,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate2"]("",p["\u0275\u0275pipeBind1"](3,4,"ARENA.type"),": ",e.pokemon.type,""),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate2"]("",p["\u0275\u0275pipeBind1"](6,6,"ARENA.multiplier"),": ",e.pokemon.attackMultiplier,"")}}function S(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",6),p["\u0275\u0275elementStart"](1,"div",7),p["\u0275\u0275element"](2,"span",8),p["\u0275\u0275elementStart"](3,"span",9),p["\u0275\u0275listener"]("mouseover",function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().infoModal=!0})("mouseout",function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().infoModal=!1}),p["\u0275\u0275text"](4,"i"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](5,w,7,8,"div",10),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](6,"p",11),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("innerHtml",e.pokemon.name,p["\u0275\u0275sanitizeHtml"]),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",e.infoModal),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("innerHtml","HP: "+e.pokemon.hp,p["\u0275\u0275sanitizeHtml"])}}const I=function(e,t){return{blue:e,attacked:t}};let _=(()=>{class e{constructor(){this.infoModal=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-battle-card"]],inputs:{title:"title",pokemon:"pokemon",type:"type"},decls:5,vars:8,consts:[[1,"card",3,"ngClass"],["class","title",3,"innerHtml",4,"ngIf"],["class","pokemon-data",4,"ngIf"],[1,"pokemon-visual"],[3,"src","alt"],[1,"title",3,"innerHtml"],[1,"pokemon-data"],[1,"pokemon-data--name"],[3,"innerHtml"],[1,"info",3,"mouseover","mouseout"],["class","info-modal",4,"ngIf"],[1,"pokemon-data--hp",3,"innerHtml"],[1,"info-modal"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275template"](1,O,1,1,"p",1),p["\u0275\u0275template"](2,S,7,3,"div",2),p["\u0275\u0275elementStart"](3,"div",3),p["\u0275\u0275element"](4,"img",4),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275property"]("ngClass",p["\u0275\u0275pureFunction2"](5,I,"blue"===t.type,t.pokemon.attacked)),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.title),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.pokemon),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("src",t.pokemon.image,p["\u0275\u0275sanitizeUrl"])("alt",t.pokemon.name))},directives:[o.i,o.k],pipes:[y.c],styles:[".pokemon-data[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:15px;font-weight:600}.pokemon-data--name[_ngcontent-%COMP%]{position:relative}.pokemon-visual[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:.2s}.info-modal[_ngcontent-%COMP%]{position:absolute;top:150%;left:calc(100% - 18px);background:var(--background-light);border-radius:3px;box-shadow:0 0 5px 0 rgba(0,0,0,.1);padding:10px 15px;width:200px;text-align:left}.info-modal[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:400;margin:3px 0 5px;text-transform:capitalize}.attacked[_ngcontent-%COMP%]{background-color:red}.attacked[_ngcontent-%COMP%]   .pokemon-visual[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(.95)}.info[_ngcontent-%COMP%]{display:inline-block;width:18px;height:18px;border:2px solid grey;border-radius:50%;font-size:12px;vertical-align:bottom;color:grey;margin-left:3px;font-style:italic;font-family:initial;cursor:help}"]}),e})();function A(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"p",9),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](2,1,"ARENA.progressStage0")))}function R(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"a",13),p["\u0275\u0275listener"]("click",function(){p["\u0275\u0275restoreView"](e);const n=t.index;return p["\u0275\u0275nextContext"](2).selectPokemon(n)}),p["\u0275\u0275elementStart"](1,"span",14),p["\u0275\u0275element"](2,"img",15),p["\u0275\u0275elementStart"](3,"span"),p["\u0275\u0275text"](4),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("src",e.image,p["\u0275\u0275sanitizeUrl"])("alt",e.name),p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate"](e.name)}}function j(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",10),p["\u0275\u0275elementStart"](1,"h2"),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"div",11),p["\u0275\u0275template"](5,R,5,3,"a",12),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](3,2,"ARENA.progressStage1")),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngForOf",e.selectedPokemons)}}function N(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",16),p["\u0275\u0275elementStart"](1,"div",11),p["\u0275\u0275elementStart"](2,"div",17),p["\u0275\u0275elementStart"](3,"div",18),p["\u0275\u0275element"](4,"app-battle-card",19),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](5,"div",17),p["\u0275\u0275elementStart"](6,"div",20),p["\u0275\u0275element"](7,"app-battle-card",21),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("title",e.player)("pokemon",e.playerPokemon),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("pokemon",e.enemyPokemon)}}function T(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"li",17),p["\u0275\u0275elementStart"](1,"app-ui-button",30),p["\u0275\u0275listener"]("emitter",function(){p["\u0275\u0275restoreView"](e);const n=t.index,o=t.$implicit;return p["\u0275\u0275nextContext"](3).launchAttack(n,o,"player")}),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("text",e.move.name)("full",!0)}}const H=function(e){return{name:e}};function B(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",11),p["\u0275\u0275element"](1,"p",27),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementStart"](3,"ul",28),p["\u0275\u0275template"](4,T,2,2,"li",29),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind2"](2,2,"ARENA.playerTurnMsg",p["\u0275\u0275pureFunction1"](5,H,e.playerPokemon.name)),p["\u0275\u0275sanitizeHtml"]),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngForOf",e.playerPokemon.attacks)}}function D(e,t){if(1&e&&(p["\u0275\u0275element"](0,"p",31),p["\u0275\u0275pipe"](1,"translate")),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind2"](1,1,"ARENA.enemyTurnMsg",p["\u0275\u0275pureFunction1"](4,H,e.enemyPokemon.name)),p["\u0275\u0275sanitizeHtml"])}}function z(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",22),p["\u0275\u0275elementStart"](1,"div",23),p["\u0275\u0275elementStart"](2,"div",24),p["\u0275\u0275template"](3,B,5,7,"div",25),p["\u0275\u0275template"](4,D,2,6,"ng-template",null,26,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275reference"](5),t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",t.playerTurn)("ngIfElse",e)}}function F(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",32),p["\u0275\u0275elementStart"](1,"app-ui-button",8),p["\u0275\u0275listener"]("emitter",function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().restartArena()}),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}2&e&&(p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("text",p["\u0275\u0275pipeBind1"](2,1,"ARENA.reload")))}const V=[{path:"",component:(()=>{class e{constructor(e,t,n){this.pokeApi=e,this.storage=t,this.utils=n,this.selectedPokemonIds=[],this.selectedPokemons=[],this.playerPokemon={},this.enemyPokemon={},this.progressStage=0}ngOnInit(){this.getUserData(),this.prepareArena()}restartArena(){this.progressStage=0,this.selectedPokemons=[],this.selectedPokemonIds=[],this.showModal=!1,this.prepareArena()}getUserData(){this.storage.getItem(l.b.DB_SETTINGS).toPromise().then(e=>{this.player=e.player})}prepareArena(){this.pokeApi.getPokemonCount({limit:1}).pipe(Object(i.a)(1)).subscribe(e=>{this.pokemonCount=e.count,this.selectedPokemonIds=this.utils.getRandomItems(850,2,c.Number),this.getSelectedPokemonsData()})}getSelectedPokemonsData(){let e=[];this.selectedPokemonIds.forEach(t=>{e.push(()=>this.pokeApi.getPokemonById(t+1).toPromise())}),Promise.all(e.map(e=>e())).then(e=>{e.forEach(e=>{e.moves.length?this.mapPokemon(e):this.getNewPokemon()}),this.progressStage=1})}getNewPokemon(){const e=this.utils.getRandomItems(850,1,c.Number)[0]+1;this.pokeApi.getPokemonById(e).toPromise().then(e=>{e.moves.length?this.mapPokemon(e):this.getNewPokemon()})}mapPokemon(e){return r(this,void 0,void 0,function*(){const t=this.utils.getRandomItems(e.moves,4,c.Object),n=this.utils.filterArrays(e.moves,t),o=e.types[0].type.name,a=yield this.pokeApi.getPokemonType(o).toPromise(),r=new s(e.name,e.stats[0].base_stat,e.stats[2].base_stat,e.sprites.other["official-artwork"].front_default,o,a,t,n);this.selectedPokemons.push(r)})}getAttackMultiplier(e,t){let n=1;for(const[o,a]of Object.entries(e))a.forEach(e=>{if(e.name===t)switch(o){case"doubleDamageFrom":n=2;break;case"halfDamageFrom":n=.5;break;case"noDamageFrom":n=0}});return n}selectPokemon(e){this.playerPokemon=this.selectedPokemons[e],this.enemyPokemon=this.selectedPokemons.find((t,n)=>n!=e),this.playerPokemon.attackMultiplier=this.getAttackMultiplier(this.playerPokemon.typeRelations,this.enemyPokemon.type),this.enemyPokemon.attackMultiplier=this.getAttackMultiplier(this.enemyPokemon.typeRelations,this.playerPokemon.type),this.startBattle()}startBattle(){this.progressStage=2,this.playerTurn=!0}launchAttack(e,t,n){return r(this,void 0,void 0,function*(){const o=yield this.pokeApi.getPokemonMove(t.move.url).toPromise();let a=this.playerPokemon,r=this.enemyPokemon;"enemy"===n&&(a=this.enemyPokemon,r=this.playerPokemon),this.applyDamage(r,o,a.attackMultiplier),a=this.addNewAttack(a,e)})}applyDamage(e,t,n){e.hp=e.hp-t.power*n,e.attacked=!0,this.playerTurn=!this.playerTurn,setTimeout(()=>{e.attacked=!1},200),e.hp<=0?this.showResultModal():this.checkTurn()}addNewAttack(e,t){e.attacks=e.attacks.filter((e,n)=>n!=t);const n=this.utils.getRandomItems(e.moves,1,c.Object);return e.attacks=[...e.attacks,...n],e.moves=this.utils.filterArrays(e.moves,e.attacks),e}checkTurn(){this.playerTurn||setTimeout(()=>{const e=this.utils.getRandomItems(this.enemyPokemon.attacks,1,c.Object)[0],t=this.enemyPokemon.attacks.findIndex(t=>t.move.name==e.move.name);this.launchAttack(t,e,"enemy")},1e3)}showResultModal(){this.progressStage=3,setTimeout(()=>{this.showModal=!this.showModal},500)}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](g),p["\u0275\u0275directiveInject"](u.a),p["\u0275\u0275directiveInject"](m))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-v-arena"]],decls:14,vars:13,consts:[[1,"view","page"],["class","themed",4,"ngIf"],["class","pokemon-selection",4,"ngIf"],["class","pokemon-battle",4,"ngIf"],["class","pokemon-actions",4,"ngIf"],["class","restart-arena",4,"ngIf"],[3,"trigger"],[3,"result"],[3,"text","emitter"],[1,"themed"],[1,"pokemon-selection"],[1,"grid"],["class","grid--item col6 pgr-item","href","javascript:void(0);",3,"click",4,"ngFor","ngForOf"],["href","javascript:void(0);",1,"grid--item","col6","pgr-item",3,"click"],[1,"inner"],[3,"src","alt"],[1,"pokemon-battle"],[1,"grid--item","col6"],[1,"pokemon","player"],[3,"title","pokemon"],[1,"pokemon","enemy"],["title","COM","type","blue",3,"pokemon"],[1,"pokemon-actions"],[1,"card"],[1,"actions"],["class","grid",4,"ngIf","ngIfElse"],["playerWaiting",""],[1,"grid--item","col6",3,"innerHTML"],[1,"grid--item","col6","grid"],["class","grid--item col6",4,"ngFor","ngForOf"],[3,"text","full","emitter"],[1,"waiting",3,"innerHTML"],[1,"restart-arena"]],template:function(e,t){1&e&&(p["\u0275\u0275element"](0,"app-header"),p["\u0275\u0275elementStart"](1,"div",0),p["\u0275\u0275elementStart"](2,"h1"),p["\u0275\u0275text"](3),p["\u0275\u0275pipe"](4,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](5,A,3,3,"p",1),p["\u0275\u0275template"](6,j,6,4,"div",2),p["\u0275\u0275template"](7,N,8,3,"div",3),p["\u0275\u0275template"](8,z,6,2,"div",4),p["\u0275\u0275template"](9,F,3,3,"div",5),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](10,"app-ui-modal",6),p["\u0275\u0275elementStart"](11,"app-battle-result",7),p["\u0275\u0275elementStart"](12,"app-ui-button",8),p["\u0275\u0275listener"]("emitter",function(){return t.restartArena()}),p["\u0275\u0275pipe"](13,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](4,9,"ARENA.title")),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",0==t.progressStage),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",1==t.progressStage),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.progressStage>=2),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",2==t.progressStage),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",0!=t.progressStage),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("trigger",t.showModal),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("result",t.playerPokemon.hp>0),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("text",p["\u0275\u0275pipeBind1"](13,11,"ARENA.reload")))},directives:[P,o.k,k,E,C.a,o.j,_],pipes:[y.c],styles:[".pgr-item[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{background-color:azure;display:block;padding-bottom:10px}.pgr-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:20px;color:grey}.pgr-item[_ngcontent-%COMP%]:hover   .inner[_ngcontent-%COMP%]{background-color:#e6e6fa}.pokemon-actions[_ngcontent-%COMP%]{margin-top:10px}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   p.waiting[_ngcontent-%COMP%]{text-align:right}.pokemon-actions[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .single-action[_ngcontent-%COMP%]{width:100%}.restart-arena[_ngcontent-%COMP%]{margin-top:50px;text-align:center}"]}),e})()}];let L=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b.forChild(V)],a.b]}),e})();var U=n("j1ZV");let K=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.b,L,y.b,U.a]]}),e})()}}]);